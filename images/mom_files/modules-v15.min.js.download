/*! michaelkorscom v1.0.0 | 2024-04-11T17:01:30 | 6a0bcaaa9fc67027b15f255bf6b8f4a4543886c3 | Copyright. All rights reserved. 2024. Digital Media Technologies Ltd. */
"use strict";!function(){if("function"==typeof window.CustomEvent)return;function t(t,e){e=e||{bubbles:!1,cancelable:!1,detail:void 0};var a=document.createEvent("CustomEvent");return a.initCustomEvent(t,e.bubbles,e.cancelable,e.detail),a}t.prototype=window.Event.prototype,window.CustomEvent=t}(),function(g){function i(){var t;switch(q){case"product":t=taggstar.getDetail("product")&&taggstar.getDetail("product").experienceId&&taggstar.getDetail("product").experienceId.replace(":","-");break;case"category":t=taggstar.getDetail("category")&&taggstar.getDetail("category").experienceId&&taggstar.getDetail("category").experienceId.replace(":","-");break;case"basket":t=taggstar.getDetail("basket")&&taggstar.getDetail("basket").experienceId&&taggstar.getDetail("basket").experienceId.replace(":","-")}return t}function s(){var t=M(g.mkorsData,"page.countryLanguage");return t&&t.replace(/(\w{2}):(\w{2})/g,"$2-$1")||"en-US"}function o(){var t=O[q]||767,e="desktop";return taggstar.$(window).width()<=t&&(e="mobile"),e}function c(){return"mobile"===o()}function d(){function t(t){return t&&-1<C.indexOf(t)}var e=taggstar.$("body").data("tagg-insert-function"),a=taggstar.$("body").data("tagg-insert-function-m");return c()&&t(a)&&(e=a),t(e)||(e=$[q][o()]),e}function u(t){var e;return t&&L.test(t)&&"category"===q&&(e="tagg-top"),t&&L.test(t)&&"product"===q&&(e="tagg-pdp-top"),e}function l(t,e){var a,r,n;switch(q){case"category":a=taggstar.$('.product-tile-show[data-product-id="'+t+'"]'),e||a.find(".tagg-category-page").remove();break;case"basket":a=taggstar.$('.cartproduct-card[data-product-id="'+t+'"]:first'),e||a.find(".tagg-basket-page").remove()}return(n=function(e){function t(t){return t&&F(t,e).length}var a=taggstar.$("body").data("tagg-anchor"),r=taggstar.$("body").data("tagg-anchor-m");return c()&&t(r)&&(a=r),t(a)||(a=R[q][o()]),F(a,e)}(a)).length&&!e&&(r=u(t))&&n.addClass(r),n}function e(a){return new Promise(function(t){try{var e=new CustomEvent("taggstar:response",{detail:function(t){var e={},a=taggstar.getVisitor();return e.version=3,e.visitor=a&&a.id,e.module=A.module,A.experienceRequired||t&&t.hasOwnProperty("experiment")&&t.experiment&&(e.experiment={id:t.experiment.id,group:t.experiment.group}),t.action?(e.type="action",e.action=t.action):(e.type="socialProof",e.socialProof=function(t){var e,a,r,n,o,g,i,s=[],c=t.socialProof;if(c)for(e=0;e<c.length;e++)for(r=(n=c[e]).product&&n.product.id,o=n.messages,a=0;a<o.length;a++)i={productId:r,code:(g=o[a]).code,data:g.data,text:g.message},s.push(i);return s}(t)),e}(a)});document.dispatchEvent(e)}catch(t){taggstar.log("error submitting tracking object")}finally{t(a)}})}function t(){var e,t;return k=A.experienceRequired?k||taggstar.params&&taggstar.params.taggExperienceId||taggstar.$("body").data("tagg-experience"):void 0,I={category:g.mkorsData.page.atgCategoryID||"-",products:[]},(t=document.querySelector('.product-grid[itemid="#product"]'))&&t.querySelectorAll(".product-tile-show").forEach(function(t){t.getAttribute("data-tagg-processed")||(e=t.getAttribute("data-product-id"))&&(I.products.indexOf(e)<0&&I.products.push(e),-1<N.indexOf(e)&&t.setAttribute("tagg-pride-design",!0),-1<B.indexOf(e)&&t.setAttribute("tagg-watch-hunger-design",!0),t.setAttribute("data-tagg-processed",!0))}),(!A.experienceRequired||k)&&I.category&&I.products.length&&l(M(I,"products.0"),!0).length}function a(){A.experienceRequired&&(T.experienceId=k),T.detail=!0,T.locale=s(),Object.keys(T).length&&taggstar.init(T),taggstar.categoryRequest(I).then(e).then(taggstar.handleResponseMulti).then(function(t){var e=i();taggstar.displayMessageBalloonsMulti(t,l,{extraClass:"tagg-category-page tagg-"+j+" tagg-"+e+" tagg-"+s()+" tagg-mothers-day",insertFunction:d()}).catch(S)}).catch(S)}function p(t,e,a){var r=0<taggstar.$(".tagg-balloons-wrapper").find("div.tagg-balloon").length,n={opacity:1};e.css({opacity:0}),taggstar.$(".tagg-balloons-wrapper").append(e),r?(n.opacity=0,setInterval(function(){n.opacity=0===n.opacity?1:0,e.css(n),e.prev().css({opacity:1===n.opacity?0:1})},4e3)):setTimeout(function(){t.css({opacity:1}),n.opacity=1,e.css(n)},a.firstDelay)}function r(){var a;return k=A.experienceRequired?k||taggstar.params&&taggstar.params.taggExperienceId||taggstar.$("body").data("tagg-experience"):void 0,w={lineItems:[]},0===taggstar.$("#tagg_exec").length&&Object.values(M(g.mkorsData,"cart.product")).forEach(function(t){var e=document.querySelector('.cartproduct-card[data-product-id="'+M(t,"mfrItemNum")+'"');e.getAttribute("data-tagg-hasprocessed")||(a=M(t,"mfrItemNum"),w.lineItems.push({id:a,unitPrice:M(t,"pricePer"),category:M(t,"category"),quantity:M(t,"qty")}),e.setAttribute("data-tagg-hasprocessed",!0),-1<N.indexOf(a)&&taggstar.$(e).attr("tagg-pride-design",!0),-1<B.indexOf(a)&&taggstar.$(e).attr("tagg-watch-hunger-design",!0))}),(!A.experienceRequired||k)&&w.lineItems.length&&l(M(w,"lineItems.0.id"),!0).length}function n(){var t=i();taggstar.$(".tagg-basket-page").remove(),taggstar.displayMessageBalloonsMulti(D,l,{wrapperClass:"tagg-balloons-wrapper",extraClass:"tagg-basket-page tagg-"+j+" tagg-"+t+" tagg-mothers-day",insertFunction:d()}).then(function(){taggstar.$(".tagg-basket-page").slideDown()}).catch(S)}function m(){D?n():(A.experienceRequired&&(T.experienceId=k),T.locale=s(),T.detail=!0,Object.keys(T).length&&taggstar.init(T),w.lineItems.length&&taggstar.basketRequest(w).then(e).then(taggstar.handleResponseMulti).then(function(t){D=t,n()}).catch(S))}function f(){return q=g.mkorsData?function(){var t=M(g.mkorsData,"page.type");return"SubCategory"===t||"Trend"===t||"Category"===t}()?"category":function(){var t=M(g.mkorsData,"page.type");return"Product Detail"===t||"Product Detail Monogramming"===t||"Product Detail Engraving"===t||0===t.indexOf("Product Detail")}()?"product":"Shopping Cart"===M(g.mkorsData,"page.type")?"basket":"checkout:confirmation"===M(g.mkorsData,"page.type")?"conversion":taggstar.constant.null:(taggstar.log("MKORS data is loading..."),taggstar.constant.null)}function v(o,g){return new Promise(function(t,e){var a,r=0,n=!1;h=!0,taggstar.log("booting..."),b=setInterval(function(){if(h){if(!a)try{A.module=a=o()}catch(t){return++r>=A.tries?(clearInterval(b),h=!1,void e(t instanceof taggstar.exception.Error?t:new taggstar.exception.Error({stack:t.stack,name:t.name,message:t.message,code:"CORE03",severity:99,module:"socialproof"}))):void 0}if(a&&a!==taggstar.constant.null){if(!n)try{n=g[a].condition()}catch(t){return++r>=A.tries?(clearInterval(b),h=!1,void e(t instanceof taggstar.exception.Error?t:new taggstar.exception.Error({stack:t.stack,name:t.name,message:t.message,code:"CORE28",severity:99}))):void 0}if(n){if(clearInterval(b),h=!1,"function"!=typeof g[a].module)return void e(new taggstar.exception.Error({message:"settings invalid (module function exists? )",code:"CORE32",severity:99}));taggstar.log("successful boot");try{g[a].module(),t(!0)}catch(t){return void e(t instanceof taggstar.exception.Error?t:new taggstar.exception.Error({stack:t.stack,name:t.name,message:t.message,code:"CORE33",severity:99}))}}else++r%5==0&&taggstar.log("waiting for condition function","warn")}else{if(++r>=A.tries)return clearInterval(b),h=!1,void(a===taggstar.constant.null?(taggstar.log("null module detected!","warn"),t(!0)):e(new taggstar.exception.Error({message:"booting failed during module detection (data layer missing?)",code:"CORE29",severity:99,module:"socialproof"})));a===taggstar.constant.null&&(a=void 0),r%5==0&&taggstar.log("waiting for module detection function","warn")}}},A.interval)})}function y(e){var t=g.mkorsData.event.filter(function(t){return t.eventInfo.eventName===e}).sort(function(t,e){return t.eventInfo.timeStamp.getTime()-e.eventInfo.timeStamp.getTime()}).pop();return"addToCart"===e?t&&Array.isArray(t.product)&&t.product.length&&t.product[0].mfrItemNum:t&&t.product.mfrItemNum}var h,b,k,x,I,w,E,D,C=["before","after","prepend","append"],$={category:{desktop:"prepend",mobile:"prepend"},product:{desktop:"append",mobile:"append"},basket:{desktop:"append",mobile:"append"}},R={category:{desktop:".image-container  a:first-child",mobile:".image-container  a:first-child"},product:{desktop:".large-images-container:first",mobile:".images-shimmer .slick-list:first"},basket:{desktop:".product-name",mobile:".product-name"}},O={category:1023,product:1023,basket:700},q="",P=!0,T={},A=taggstar.config,M=taggstar.util.getObjectByPath,S=taggstar.exception.handle,j=A.key,L=/^MK|^3|^4|^5/i,N=["30F3G7WT7C","30S3S04M6L","30S3S5EB2L"],B=["32F2G01T3O","30F2MTVT3O","MK7427","MH3517V97J","30H3GTVT7C"],F=function(t,e){var a;return(a=e?e.is(t)?e:e.find(t):taggstar.$(t)).selector||(a.selector=t),a},G={category:{condition:t,module:function(){try{a(),b=setInterval(function(){t()&&a()},3*A.interval)}catch(t){clearInterval(b)}}},product:{condition:function(){return k=A.experienceRequired?k||taggstar.params&&taggstar.params.taggExperienceId||taggstar.$("body").data("tagg-experience"):void 0,x={id:M(g.mkorsData,"product.0.mfrItemNum"),name:M(g.mkorsData,"product.0.name"),price:M(g.mkorsData,"product.0.basePrice"),category:M(g.mkorsData,"product.0.categoryName")},(!A.experienceRequired||k)&&x.id&&l().length},module:function(){A.experienceRequired&&(T.experienceId=k),T.detail=!0,T.locale=s(),Object.keys(T).length&&taggstar.init(T),taggstar.productRequest(x).then(e).then(taggstar.handleProductResponse).then(function(t){var e=u(M(g.mkorsData,"product.0.mfrItemNum")),a=taggstar.$('<div class="tagg-sticky '+(e||"")+'"></div>'),r=i(),n=-1<N.indexOf(x.id),o=-1<B.indexOf(x.id);taggstar.$(l().selector).append(a),taggstar.displayMessageBalloons(t,".tagg-sticky",{extraClass:"tagg-product-page tagg-"+j+" tagg-"+r+(n?" tagg-pride-design":"")+(o?" tagg-watch-hunger-design":"")+" tagg-"+s()+" tagg-mothers-day",insertFunction:d(),customAnimation:p,firstDelay:0,delayBetween:500}).catch(S)}).catch(S)}},basket:{condition:r,module:function(){var e;try{m(),e=setInterval(function(){r()&&m()},3*A.interval)}catch(t){clearInterval(e)}}},conversion:{condition:function(){var t;return E={id:M(g.mkorsData,"transaction.orderID"),currency:M(g.mkorsData,"transaction.currency"),totalPrice:M(g.mkorsData,"transaction.totalPrice"),orderItems:[]},t=M(g.mkorsData,"transaction.product"),Object.values(t).forEach(function(t){E.orderItems.push({id:M(t,"mfrItemNum"),unitPrice:M(t,"pricePer"),category:M(t,"category"),quantity:M(t,"qty")})}),E.id&&E.currency&&E.totalPrice&&E.orderItems.length},module:function(){T.currencyCode=E.currency,T.locale=s(),taggstar.init(T),taggstar.conversionRequest(E).then(e).then(function(t){taggstar.log("conversion successful","info"),taggstar.log(t,"info")}).catch(S)}}};!function(){var t,e,a,r,n=taggstar.util.getCookie("_taggstar_dbg");if(n)for(taggstar.debug=!0,t=n.split("|"),e=0;e<t.length;e++)switch((a=t[e].split(":"))[0]){case"kui":taggstar.keepUI="true"===a[1];break;case"prd":r=a[1];break;case"id":"client"===r&&a[1]&&(taggstar.params.taggExperienceId=a[1]),"server"===r&&a[1]&&(taggstar.params.taggExperimentId=a[1]);break;case"grp":"server"===r&&a[1]&&(taggstar.params.taggExperimentGroup=a[1])}}(),new Promise(function(t,e){var a,r=0,n=A.tries,o=A.interval;taggstar.log("init..."),a=setInterval(function(){if(P){if(taggstar.$||(taggstar.$=window.jQuery),!taggstar.$)return n<=++r?(clearInterval(a),P=!1,void e(new taggstar.exception.Error({message:"jQuery couldn't be loaded. jQuery not found",code:"CORE02",severity:99,module:"socialproof"}))):void(r%5==0&&taggstar.log("jQuery not loaded","warn"));clearInterval(a),t(!(P=!1))}},o)}).then(function(){v(f,G).catch(S)}).catch(S),g.addEventListener("pageChange",function(){clearInterval(b),!(h=!1),P?taggstar.log("not initialized yet!"):v(f,G).catch(S)},!1),g.addEventListener("refinementApplied",function(){taggstar.$(".tagg-balloons-wrapper").remove(),taggstar.$(".product-tile .image-panel").removeAttr("data-tagg-processed")}),g.addEventListener("addToCart",function(){var t={category:"basket",name:"add",data:{label:y("addToCart"),value:1}};taggstar.eventRequest(t).then(function(){delete t.eventGroupId,e({action:t})}).catch(S),taggstar.log("ATB clicked")},!1),g.addEventListener("addToWishList",function(){var t={category:"wishlist",name:"add",data:{label:y("addToWishList"),value:1}};taggstar.eventRequest(t).then(function(){delete t.eventGroupId,e({action:t})}).catch(S),taggstar.log("ATW clicked")},!1)}(window);